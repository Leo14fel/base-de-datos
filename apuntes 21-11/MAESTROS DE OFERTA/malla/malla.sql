CREATE DATABASE	MALLA;
USE MALLA;

CREATE TABLE MATERIA
( SIGLA VARCHAR(6) NOT NULL PRIMARY KEY,
NOMBRE VARCHAR(44) NOT NULL,
SEMESTRE tinyint NOT NULL 
);

CREATE TABLE PRERREQUISITO
(SIGLAMAT VARCHAR (6) NOT NULL ,
SIGLAPRE varchar(6) NOT NULL ,
PRIMARY KEY(SIGLAMAT, SIGLAPRE),
FOREIGN KEY (SIGLAMAT) REFERENCES MATERIA (SIGLA)
ON UPDATE NO ACTION
ON DELETE NO ACTION,
FOREIGN KEY (SIGLAPRE) REFERENCES MATERIA (SIGLA)
ON UPDATE NO ACTION
ON DELETE NO ACTION	
);
INSERT INTO MATERIA VALUES
('MAT101','CALCULO I',1),
('INF119','ESTRUCTURAS DISCRETAS',1),
('INF110','INTRODUCCION A LA INFORMATICA',1),
('FIS100','FISICA I',1),
('LIN100','INGLES TECNICO I',1),
('MAT102','CALCULO II',2),
('MAT103','ALGEBRA LINEAL',2),
('INF120','PROGRAMACION I',2),
('FIS102','FISICA II',2),
('LIN101','INGLES TECNICO II',2),
('MAT207','ECUACIONES DIFERENCIALES',3),
('INF210','PROGRAMACION II',3),
('INF211','ARQUITECTURA DE COMPUTADORAS',3),
('FIS200','FISICA III',3),
('ADM100','ADMINISTRACION',3),
('MAT202','PROBABILIDADES Y ESTADISTICAS',4),
('MAT205','METODOS NUMERICOS',4),
('INF220','ESTRUCTURA DE DATOS I',4),
('INF221','PROGRAMACION ENSAMBLADOR',4),
('ADM200','CONTABILIDAD',4),
('MAT302','PROBABILIDADES Y ESTADISTICAS II',5),
('INF318','PROGRAMACION LOGICA Y FUNCIONAL',5),
('INF310','ESTRUCTURA DE DATOS II',5),
('INF312','BASE DE DATOS I',5),
('INF319','LENGUAJES FORMALES',5),
('MAT329','INVESTIGACION OPERATIVA I',6),
('INF342','SISTEMA DE INFORMACION I',6),
('INF323','SISTEMAS OPERATIVOS I',6),
('INF322','BASE DE DATOS II',6),
('INF329','COMPILADORES',6),
('MAT419','INVESTIGACION OPERATIVA II',7),
('INF418','INTELIGENCIA ARTIFICIAL',7),
('INF413','SISTEMAS OPERATIVOS II',7),
('INF433','REDES I',7),
('INF412','SISTEMAS DE INFORMACION I',7),
('ECO449','PREPARACION Y EVALUACION DE PROYECTOS',8),
('INF428','SISTEMAS EXPERTOS',8),
('INF442','SISTEMAS DE INFORMACION GEOGRAFICA',8),
('INF423','REDES II',8),
('INF422','INGENIERIA DE SOFTWARE I',8),
('INF511','TALLER DE GRADO I',9),
('INF512','INGENIERIA DE SOFTWARE II',9),
('INF513','TECNOLOGIA WEB',9),
('INF552','ARQUITECTURA DE SOFTWARE',9),
('GRL001','MODALIDAD DE TITULACION DE LICENCIATURA',10),
('ELC101','MODALIDAD Y SIMULACION DE SISTEMAS',11),
('ELC102','PROGRAMACION GRAFICA',11),
('ELC103','TOPICOS AVANZADOS DE PROGRAMACION',11),
('ELC104','PROGRAMACION DE APLICACIONES DE TIEMPO REAL',11),
('ELC105','SISTEMAS DISTRIBUIDOS',11),
('ELC106','INTERACCION HOMBRE-COMPUTADOR',11),
('ELC107','CRIPTOGRAFIA Y SEGURIDAD',11),
('ELC108','CONTROL Y AUTOMATIZACION',11);

INSERT INTO PRERREQUISITO VALUES
('MAT102','MAT101'),
('MAT103','INF119'),
('INF120','INF110'),
('FIS102','FIS100'),
('LIN101','LIN100'),
('MAT207','MAT102'),
('INF210','MAT103'),
('INF210','INF120'),
('INF211','INF120'),
('INF211','FIS102'),
('FIS200','FIS102'),
('MAT202','MAT102'),
('MAT205','MAT207'),
('INF220','INF210'),
('INF221','INF211'),
('ADM200','ADM100'),
('MAT302','MAT202'),
('INF318','INF220'),
('INF310','INF220'),
('INF312','INF220'),
('INF319','INF220'),
('MAT329','MAT302'),
('INF342','INF312'),
('INF323','INF310'),
('INF322','INF312'),
('INF329','INF310'),
('INF329','INF319'),
('MAT419','MAT329'),
('INF418','INF318'),
('INF418','INF310'),
('INF413','INF323'),
('INF433','INF323'),
('INF412','INF342'),
('INF412','INF322'),
('ECO449','MAT419'),
('INF428','INF418'),
('INF428','INF412'),
('INF442','INF412'),
('INF423','INF433'),
('INF422','INF412'),
('INF511','ECO449'),
('INF511','INF428'),
('INF511','INF442'),
('INF511','INF423'),
('INF511','INF422'),
('INF512','INF428'),
('INF512','INF442'),
('INF512','INF423'),
('INF512','INF422'),
('INF513','INF428'),
('INF513','INF442'),
('INF513','INF423'),
('INF513','INF422'),
('INF552','INF428'),
('INF552','INF442'),
('INF552','INF423'),
('INF552','INF422'),
('GRL001','INF511'),
('GRL001','INF512'),
('GRL001','INF513'),
('GRL001','INF552');

SELECT COUNT(*) FROM PRERREQUISITO;

SELECT * FROM PRERREQUISITO, MATERIA;

/* MOSTRAR LAS MATERIAS QUE NO TIENEN PREREQUISITO */
SELECT * FROM MATERIA
WHERE SIGLA NOT IN (SELECT SIGLAMAT
					FROM PRERREQUISITO);

/* MOSTRAR LAS MATERIAS QUE NO SON PREREQUISITO */

SELECT * 
FROM MATERIA
WHERE SIGLA NOT IN (SELECT SIGLAPRE
					FROM PRERREQUISITO);

/* MOSTRAR LAS MATERIAS DE SEGUNDO SEMESTRE, QUE SON PREREQUISITOS DE MATERIAS DE CUARTO SEMESTRE*/

SELECT *
FROM MATERIA
WHERE SEMESTRE =2 AND SIGLA IN  (SELECT SIGLAPRE
								FROM PRERREQUISITO
								WHERE SIGLAMAT IN (SELECT SIGLA
													FROM MATERIA
                                                    WHERE MATERIA.SEMESTRE=4));
                                                    
/*CUANDO USAMOS ON UPDATE CASCADA, LAS LLAVES FORANEAS SE ACTUALIZAN EN DIFERENTES TABLAS SI SE HACE CAMBION EN UNA, 
MIENTRAS EL ON UPDATE NO ACTION NO LO HACE*/

