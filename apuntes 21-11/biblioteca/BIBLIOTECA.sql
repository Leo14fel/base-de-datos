CREATE DATABASE BIBLIOTECA;
USE BIBLIOTECA;
DROP database BIBLIOTECA
CREATE TABLE TIPOUSUARIO
(
ID tinyint NOT NULL PRIMARY KEY,
NOMBRE VARCHAR(60) NOT NULL
);

CREATE TABLE USUARIO (
CI INTEGER NOT NULL PRIMARY KEY,
NOMBRE VARCHAR(60) NOT NULL, 
DIRECCION VARCHAR(60) NOT NULL,
TELEFONO INTEGER NOT NULL,
IDTIPO tinyint NOT NULL,
FOREIGN KEY (IDTIPO) REFERENCES TIPOUSUARIO(ID)
ON UPDATE CASCADE
ON DELETE CASCADE
);
CREATE TABLE MATERIAL_BIBLIOGRAFICO(
CODMAT INTEGER NOT NULL PRIMARY KEY,
TITULO VARCHAR(50) NOT NULL,
NROPAG smallint NOT NULL,
EDITORIAL VARCHAR(50) NOT NULL,
TIPO CHAR NOT NULL
);

CREATE TABLE LIBRO(
CODMAT INTEGER NOT NULL PRIMARY KEY,
EDICION varchar(10) NOT NULL,
AÑOP smallint NOT NULL,
FOREIGN KEY (CODMAT) REFERENCES MATERIAL_BIBLIOGRAFICO(CODMAT)
ON UPDATE CASCADE
ON DELETE CASCADE
);

CREATE TABLE REVISTA(
CODMAT INTEGER NOT NULL PRIMARY KEY,
NRO tinyint NOT NULL,
AÑOP smallint NOT NULL,
FOREIGN KEY (CODMAT) REFERENCES MATERIAL_BIBLIOGRAFICO(CODMAT)
ON UPDATE CASCADE
ON DELETE CASCADE
);

CREATE TABLE PERIODICO(
CODMAT INTEGER NOT NULL PRIMARY KEY,
FECHA DATE NOT NULL,
FOREIGN KEY (CODMAT) REFERENCES MATERIAL_BIBLIOGRAFICO(CODMAT)
ON UPDATE CASCADE
ON DELETE CASCADE
);

CREATE TABLE FICHAPRESTAMO(
NROFICHA INTEGER NOT NULL PRIMARY KEY,
FECHA DATE NOT NULL,
HORA TIME NOT NULL,
FECHADEV DATE NOT NULL,
CODMAT INTEGER NOT NULL,
CI INTEGER NOT NULL,
FOREIGN KEY (CODMAT) REFERENCES MATERIAL_BIBLIOGRAFICO(CODMAT)
  ON UPDATE CASCADE
  ON DELETE CASCADE,
FOREIGN KEY (CI) REFERENCES USUARIO(CI)
  ON UPDATE CASCADE
  ON DELETE CASCADE
);

INSERT INTO FICHAPRESTAMO VALUES
(100,'10-08-2024','10:00:00','2024-08-12',100,222),
(101,'15-08-2024','12:00:00','2024-08-17',100,111),
(102,'15-08-2024','13:00:00','2024-08-17',101,222),
(103,'20-08-2024','9:00:00','2024-08-22',102,333);
INSERT INTO USUARIO VALUES
(111,'JOAQUIN CHUMACERO','URB LOS CHUMAS 200',7102030,2),
(222,'SATURNINO MAMANI','CALLE JUNION 300',7234559,1),
(333,'FABIOLA MENDEZ','CALLE LANDIVAR 123',7231111,1);
INSERT INTO TIPOUSUARIO VALUES
(1,'ESTUDIANTE'),
(2,'DOCENTE');
INSERT INTO MATERIAL_BIBLIOGRAFICO VALUES
(100,'BASE DE DATOS PRINCIPANTES',120,'LA HOGUERA','L'),
(101,'MAGAZINE',50,'LA PRINCIPAL','R'),
(102,'EL DEBER',40,'GENERAL','P'),
(103,'BASE DE DATOS PRINCIPANTES',100,'LA HOGUERA','L'),
(104,'PROGRAMACION SIMPLE',80,'GENERAL','R');
INSERT INTO LIBRO VALUES
(100,'1ERA EDICION','2005'),
(103,'2DA EDICION','2020');
INSERT INTO REVISTA VALUES
(101,1,2018),
(104,1,2020);
INSERT INTO PERIODICO VALUES
(102,11-08-2024);

/*MOSTRAR LA CANTIDAD DE FICHAS PRESTAMOS REALIZADO POR CADA USUARIO*/
SELECT USUARIO.CI,NOMBRE,COUNT(*)
FROM USUARIO,FICHAPRESTAMO
WHERE USUARIO.CI=FICHAPRESTAMO.CI
HAVING COUNT(*)>=2
/*MOSTRAR LOS USUSARIOS DOCENTES QUE HAN SACADO LIBRO*/

/*MOSTRAR POR CADA MATERIA BIBLIOGRAFICA CUANTAS VECES SE HA SIDO PRESTADO*/
SELECT MATERIAL_BIBLIOGRAFICO
FROM
WHERE
/*MOSTRAR LOS MATERIALES BIBLIOGRAFICOS QUE HAN SIDO PRESTADO MAS DE 1 UNA VEZ*/

/*MOSTRAR TODOS LOS DATOS DE LOS LIBRO QUE HAN SIDO SACADO, INDICADO TAMBIEN LA EL NRO DE PERSTAMO Y FECHA*/
