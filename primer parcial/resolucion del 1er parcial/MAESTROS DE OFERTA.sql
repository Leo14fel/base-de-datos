CREATE DATABASE OFERTASA;
USE OFERTASA;

CREATE TABLE DOCENTE
(
CODIGO INTEGER NOT NULL PRIMARY KEY,
NOMBRE VARCHAR(60) NOT NULL
);

CREATE TABLE MATERIA
(
SIGLA VARCHAR(10) NOT NULL PRIMARY KEY,
NOMBRE VARCHAR(100) NOT NULL
);

CREATE TABLE GRUPO
(
ID SMALLINT NOT NULL PRIMARY KEY,
NOMBRE VARCHAR(2) NOT NULL,
CODIGOD INTEGER NOT NULL,
 FOREIGN KEY (CODIGOD) REFERENCES DOCENTE (CODIGO)
 ON UPDATE CASCADE
 ON DELETE CASCADE,
 SIGLAM VARCHAR(10) NOT NULL,
 FOREIGN KEY (SIGLAM) REFERENCES MATERIA (SIGLA)
 ON UPDATE CASCADE
 ON DELETE CASCADE
);

CREATE TABLE HORARIO
(
ID SMALLINT NOT NULL PRIMARY KEY,
DIA VARCHAR(10) NOT NULL,
HI TIME,
HF TIME
);

CREATE TABLE TIENE
(
PRIMARY KEY(IDG,IDH),
IDG SMALLINT NOT NULL,
 FOREIGN KEY (IDG) REFERENCES GRUPO (ID)
 ON UPDATE CASCADE
 ON DELETE CASCADE,
 IDH SMALLINT NOT NULL,
 FOREIGN KEY (IDH) REFERENCES HORARIO (ID)
 ON UPDATE CASCADE
 ON DELETE CASCADE
);

INSERT INTO DOCENTE VALUES(111,'JOAQUIN CHUMACERO');
INSERT INTO DOCENTE VALUES(222,'SATURNINO MAMANI');
INSERT INTO DOCENTE VALUES(333,'CARLOS CAMACHO');
INSERT INTO DOCENTE VALUES(444,'FABIOLA MENDEZ');

INSERT INTO MATERIA VALUES('INF 110','INTRODUCCION A LA INFORMATICA');
INSERT INTO MATERIA VALUES('INF 119','ESTRUCTURAS DISCRETAS');
INSERT INTO MATERIA VALUES('INF 312','BASE DE DATOS 1');
INSERT INTO MATERIA VALUES('INF 552','ARQUITECTURA DE SOFTWARE');

INSERT INTO GRUPO VALUES(1,'SI',111,'INF 110');
INSERT INTO GRUPO VALUES(2,'SZ',333,'INF 110');
INSERT INTO GRUPO VALUES(3,'SH',222,'INF 119');
INSERT INTO GRUPO VALUES(4,'SA',111,'INF 312');
INSERT INTO GRUPO VALUES(5,'SC',111,'INF 312');
INSERT INTO GRUPO VALUES(6,'SA',111,'INF 552');



INSERT INTO HORARIO VALUES(1,'LUNES','07:00','08:30');
INSERT INTO HORARIO VALUES(2,'LUNES','08:30','10:00');
INSERT INTO HORARIO VALUES(3,'LUNES','10:00','11:30');
INSERT INTO HORARIO VALUES(4,'MIERCOLES','07:00','08:30');
INSERT INTO HORARIO VALUES(5,'MIERCOLES','08:30','10:00');
INSERT INTO HORARIO VALUES(6,'MIERCOLES','10:00','11:30');
INSERT INTO HORARIO VALUES(7,'VIERNES','07:00','08:30');
INSERT INTO HORARIO VALUES(8,'VIERNES','08:30','10:00');
INSERT INTO HORARIO VALUES(9,'VIERNES','10:00','11:30');
INSERT INTO HORARIO VALUES(10,'MARTES','07:00','09:15');
INSERT INTO HORARIO VALUES(11,'MARTES','09:15','11:30');
INSERT INTO HORARIO VALUES(12,'JUEVES','07:00','09:15');
INSERT INTO HORARIO VALUES(13,'JUEVES','09:15','11:30');

INSERT INTO TIENE VALUES(1,11);
INSERT INTO TIENE VALUES(1,13);
INSERT INTO TIENE VALUES(2,1);
INSERT INTO TIENE VALUES(2,4);
INSERT INTO TIENE VALUES(2,7);
INSERT INTO TIENE VALUES(4,2);
INSERT INTO TIENE VALUES(4,5);
INSERT INTO TIENE VALUES(4,8);
INSERT INTO TIENE VALUES(3,10);
INSERT INTO TIENE VALUES(3,12);
INSERT INTO TIENE VALUES(5,11);
INSERT INTO TIENE VALUES(5,13);
INSERT INTO TIENE VALUES(6,1);
INSERT INTO TIENE VALUES(6,4);
INSERT INTO TIENE VALUES(6,7);

/*1ERA PREGUNTA DE EXAMEN*/
SELECT GRUPO.ID,GRUPO.NOMBRE,SIGLAM, COUNT(IDH)
FROM GRUPO, TIENE 
WHERE GRUPO.ID=IDG
GROUP BY GRUPO.ID;

/*SEGUNDA PREGUNTA DE EXAMEN*/

SELECT CODIGO, DOCENTE.NOMBRE
FROM DOCENTE, GRUPO, TIENE, HORARIO, MATERIA
WHERE CODIGO=CODIGOD AND SIGLAM=SIGLA AND GRUPO.ID=IDG AND HORARIO.ID=IDH
AND MATERIA.NOMBRE='INTRODUCCION A LA INFORMATICA' AND HI='9:15' AND HF='11:30' AND DIA ='MARTES'